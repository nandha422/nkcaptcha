<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NK CAPTCHA</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>

  <style>
    /* ===== RESET ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Poppins", sans-serif; }

    body {
      background: linear-gradient(135deg, #dbeafe, #1e3a8a);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #0f172a;
    }

    /* ===== MAIN CONTAINER ===== */
    .container {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 255, 255, 0.4);
      border-radius: 20px;
      box-shadow: 0 0 25px rgba(59, 130, 246, 0.5);
      width: 350px;
      text-align: center;
      padding: 35px 25px;
      animation: fadeIn 1s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      margin-bottom: 20px;
      color: #1e3a8a;
      text-shadow: 0 0 15px #3b82f6;
    }

    /* ===== INPUTS ===== */
    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 15px;
      background: rgba(255, 255, 255, 0.7);
      box-shadow: inset 0 0 5px rgba(59, 130, 246, 0.5);
      transition: 0.3s;
    }
    input:focus {
      background: #fff;
      box-shadow: 0 0 15px #60a5fa;
    }

    /* ===== BUTTONS ===== */
    button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      font-weight: 600;
      background: linear-gradient(90deg, #2563eb, #60a5fa);
      color: white;
      cursor: pointer;
      transition: 0.3s;
      text-shadow: 0 0 10px rgba(255,255,255,0.6);
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.8);
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px #60a5fa;
    }

    a { color: #2563eb; cursor: pointer; text-decoration: none; }
    a:hover { text-decoration: underline; }

    .hidden { display: none; }

    /* ===== CAPTCHA DASHBOARD ===== */
    #captcha-box {
      font-size: 26px;
      font-weight: bold;
      letter-spacing: 4px;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 10px;
      background: rgba(255,255,255,0.8);
      box-shadow: inset 0 0 15px rgba(59, 130, 246, 0.6);
      color: #1e3a8a;
      text-shadow: 0 0 8px #3b82f6;
    }

    #ad-box {
      display: none;
      margin-top: 20px;
      background: rgba(240, 249, 255, 0.9);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(96, 165, 250, 0.7);
    }

    #points {
      font-weight: bold;
      color: #1e40af;
      text-shadow: 0 0 10px #60a5fa;
    }

    #captcha-container h2 {
      color: #1d4ed8;
    }

    @media (max-width: 400px) {
      .container { width: 90%; }
    }
  </style>
</head>

<body>

  <!-- LOGIN / SIGNUP -->
  <div class="container" id="auth-container">
    <h2>üîê NK CAPTCHA</h2>

    <div id="login-form">
      <input type="email" id="login-email" placeholder="Email">
      <input type="password" id="login-password" placeholder="Password">
      <button onclick="login()">Login</button>
      <p style="margin-top:10px;">No account? <a onclick="toggleForm()">Sign up</a></p>
    </div>

    <div id="signup-form" class="hidden">
      <input type="email" id="signup-email" placeholder="Email">
      <input type="password" id="signup-password" placeholder="Password">
      <button onclick="signup()">Sign Up</button>
      <p style="margin-top:10px;">Have an account? <a onclick="toggleForm()">Login</a></p>
    </div>
  </div>

  <!-- CAPTCHA DASHBOARD -->
  <div class="container hidden" id="captcha-container">
    <h2>Welcome, <span id="user-email"></span></h2>
    <p>Points: <span id="points">0</span></p>

    <div id="captcha-section">
      <div id="captcha-box"></div>
      <input type="text" id="captcha-input" placeholder="Enter Captcha">
      <button onclick="verifyCaptcha()">Submit</button>
    </div>

    <div id="ad-box">
      <h3>Sponsored Ad</h3>
      <iframe src="https://example.com" width="100%" height="150" style="border:none;border-radius:10px;"></iframe>
      <button onclick="closeAd()">Close Ad</button>
    </div>
  </div>

  <script>
    // Your Firebase Config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "captcha-e2954.firebaseapp.com",
      projectId: "captcha-e2954",
      storageBucket: "captcha-e2954.appspot.com",
      messagingSenderId: "1066492019",
      appId: "1:1066492019:web:exampleid"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let currentUser = null;
    let captchaText = "";

    function toggleForm() {
      document.getElementById('login-form').classList.toggle('hidden');
      document.getElementById('signup-form').classList.toggle('hidden');
    }

    async function signup() {
      const email = signupEmail.value;
      const password = signupPassword.value;
      await auth.createUserWithEmailAndPassword(email, password);
      alert("Signup successful!");
    }

    async function login() {
      const email = loginEmail.value;
      const password = loginPassword.value;
      try {
        const userCred = await auth.signInWithEmailAndPassword(email, password);
        currentUser = userCred.user;
        document.getElementById('auth-container').classList.add('hidden');
        document.getElementById('captcha-container').classList.remove('hidden');
        document.getElementById('user-email').innerText = currentUser.email;
        loadPoints();
        generateCaptcha();
      } catch (error) {
        alert(error.message);
      }
    }

    async function loadPoints() {
      const docRef = db.collection("users").doc(currentUser.uid);
      const docSnap = await docRef.get();
      if (docSnap.exists) {
        document.getElementById("points").innerText = docSnap.data().points || 0;
      } else {
        await docRef.set({ points: 0 });
      }
    }

    function generateCaptcha() {
      captchaText = Math.random().toString(36).substring(2, 8).toUpperCase();
      document.getElementById("captcha-box").innerText = captchaText;
      document.getElementById("captcha-input").value = "";
    }

    async function verifyCaptcha() {
      const input = document.getElementById("captcha-input").value.toUpperCase();
      if (input === captchaText) {
        const docRef = db.collection("users").doc(currentUser.uid);
        const docSnap = await docRef.get();
        let points = docSnap.data().points || 0;
        points += 1;
        await docRef.update({ points });
        document.getElementById("points").innerText = points;
        showAd();
      } else {
        alert("‚ùå Wrong captcha! Try again.");
      }
      generateCaptcha();
    }

    function showAd() {
      document.getElementById("ad-box").style.display = "block";
    }

    function closeAd() {
      document.getElementById("ad-box").style.display = "none";
    }
  </script>
</body>
</html>